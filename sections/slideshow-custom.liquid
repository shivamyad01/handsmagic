{% schema %}
{
  "name": "Slideshow - Custom",
  "settings": [],
  "blocks": [
    {
      "type": "slideshow",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "desktop_image_bro",
          "label": "Desktop Banner -bro"
        },
        {
          "type": "image_picker",
          "id": "mobile_image_bro",
          "label": "Mobile Banner -bro"
        },
        {
          "type": "url",
          "id": "banner_link_bro",
          "label": "Banner Link -bro"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Slideshow",
      "category": "Slideshow"
    }
  ]
}
{% endschema %}

<div class="slideshow-container-bro">
  <div class="slideshow-carousel-bro">
    {% for block in section.blocks %}
      <div class="slideshow-slide-bro">
        <a href="{{ block.settings.banner_link_bro }}" class="banner-link-bro">
          <img src="{{ block.settings.desktop_image_bro | img_url: 'master' }}" alt="Desktop Image -bro" class="desktop-banner-bro" />
          <img src="{{ block.settings.mobile_image_bro | img_url: 'master' }}" alt="Mobile Image -bro" class="mobile-banner-bro" />
        </a>
      </div>
    {% endfor %}
  </div>

  <!-- Arrow Buttons (hidden on mobile) -->
  <button class="slide-arrow prev-arrow">&#10094;</button>
  <button class="slide-arrow next-arrow">&#10095;</button>
</div>

<style>
  .slideshow-container-bro {
    width: 100%;
    position: relative;
    overflow: hidden;
  }

  .slideshow-carousel-bro {
    display: flex;
    transition: transform 0.5s ease-in-out;
  }

  .slideshow-slide-bro {
    min-width: 100%;
    box-sizing: border-box;
  }

  .desktop-banner-bro,
  .mobile-banner-bro {
    width: 100%;
    height: auto;
    display: none;
  }

  .banner-link-bro {
    display: block;
    text-decoration: none;
  }

  /* Show correct image based on screen size */
  @media (min-width: 768px) {
    .desktop-banner-bro {
      display: block;
    }
  }

  @media (max-width: 767px) {
    .mobile-banner-bro {
      display: block;
    }

    /* Hide arrows on mobile */
    .slide-arrow {
      display: none;
    }
  }

  .slide-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    background-color: rgba(0, 0, 0, 0.4);
    color: white;
    border: none;
    padding: 10px 15px;
    font-size: 24px;
    cursor: pointer;
    border-radius: 50%;
  }

  .prev-arrow {
    left: 10px;
  }

  .next-arrow {
    right: 10px;
  }

  .slide-arrow:hover {
    background-color: rgba(0, 0, 0, 0.6);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const slides = document.querySelectorAll('.slideshow-slide-bro');
    const carousel = document.querySelector('.slideshow-carousel-bro');
    const nextArrow = document.querySelector('.next-arrow');
    const prevArrow = document.querySelector('.prev-arrow');
    let totalSlides = slides.length;
    let currentIndex = 0;

    function goToSlide(index) {
      currentIndex = (index + totalSlides) % totalSlides;
      const offset = -currentIndex * 100;
      carousel.style.transform = 'translateX(' + offset + '%)';
    }

    function showNextSlide() {
      goToSlide(currentIndex + 1);
    }

    function showPrevSlide() {
      goToSlide(currentIndex - 1);
    }

    // Auto-slide every 5 seconds
    const interval = setInterval(showNextSlide, 5000);

    // Arrow events (desktop only)
    if (nextArrow && prevArrow) {
      nextArrow.addEventListener('click', showNextSlide);
      prevArrow.addEventListener('click', showPrevSlide);
    }

    // Touch swipe support (mobile)
    let touchStartX = 0;
    let touchEndX = 0;

    carousel.addEventListener('touchstart', function (e) {
      touchStartX = e.changedTouches[0].screenX;
    });

    carousel.addEventListener('touchend', function (e) {
      touchEndX = e.changedTouches[0].screenX;
      handleGesture();
    });

    function handleGesture() {
      const deltaX = touchEndX - touchStartX;
      if (Math.abs(deltaX) > 50) {
        if (deltaX > 0) {
          showPrevSlide();
        } else {
          showNextSlide();
        }
      }
    }
  });
</script>